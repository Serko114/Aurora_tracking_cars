# Траффик авто на фоне Авроры СПб

<a href="https://vkvideo.ru/video-18901857_456254570?ref_domain=guide-spb.fontanka.ru" target="_blank">*Источник видео*</a>

Целью данного репозитория будем считать подсчет машин с выводом в базу данных данных (Windows 10).

## Для этого:

### 1. Обучим модель YOLOv8m, будет включать классификацию (ну тут только один класс, но она есть), детекцию и треккинг.
### 2. Затем определим поле на дороге, при пересечении которого машина будет засчитываться (возможно для точности потребуется несколько полей, т.к. машины перекрывают друг друга время от вмемени).
### 3. Подсоединимся к базе данных.
### 4. Попробуем подсоединить дашборд, может быть типа grafana с выводом статистики через порт в браузер.
### 5. Пока до этого пункта доберемся, еще что-нибудь придумаем ...)

## 1. Обучение модели.
**1.1 Записываем видео с [сайта](https://guide-spb.fontanka.ru/peterburg-veb-kamery "Источник видео") в формате mp.4.**

Заходим на сайт включаем трансляцию, с момощью кнопок _Windows + Alt + R_ создаем видеофайл, от которого и будем плясать. Нужно отметить, что моделька будет хорошо работать в таких же условиях, как на видео, т.е. зима, снег, ночь, огоньки, для иных условий, например день, или лето, потребуется дообучение.

**1.2 Разбиваем видео на кадры, получая картинки в формате png**

Для этого используем программку [FFmpeg](https://ffmpeg.org/download.html).
Чтобы она работала в командной строке, необходимо прописать путь в "Переменных среды" прописать путь _C:\\ffmpeg\bin_. После этого в командной сроке пишем:
```
ffmpeg -i train.mp4 -vf fps=1.5 images_train/1_img%03d.png
```
* ffmpeg -  это команда для запуска программы FFmpeg, которая используется для обработки
видео и аудио файлов.
* --i train.mp4 - это опция для указания входного файла train.mp4.









![Traffic statistics 1](trim-video.gif)
